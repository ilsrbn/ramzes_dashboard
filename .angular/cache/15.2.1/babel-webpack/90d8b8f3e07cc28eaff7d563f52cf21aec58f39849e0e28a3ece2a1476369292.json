{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport { timer } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { animate, group, query, style, transition, trigger } from '@angular/animations';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"../tabs/tabs.component\";\nimport * as i4 from \"../notification/notification.component\";\nfunction LayoutComponent_img_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"img\", 6);\n    i0.ɵɵlistener(\"load\", function LayoutComponent_img_1_Template_img_load_0_listener($event) {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r4 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r4.onBGImageLoad($event));\n    });\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const bg_r3 = ctx.$implicit;\n    i0.ɵɵproperty(\"src\", bg_r3, i0.ɵɵsanitizeUrl)(\"@bgAnim\", undefined);\n  }\n}\nfunction LayoutComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 7);\n    i0.ɵɵlistener(\"click\", function LayoutComponent_div_2_Template_div_click_0_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.changeBGImage());\n    });\n    i0.ɵɵelementStart(1, \"i\", 8);\n    i0.ɵɵtext(2, \"refresh\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    i0.ɵɵproperty(\"@fadeAnim\", undefined);\n  }\n}\nconst baseStyles = style({\n  // display: 'block',\n  position: 'absolute',\n  top: 0,\n  left: 0,\n  width: '100%',\n  height: '100%'\n});\nexport let LayoutComponent = /*#__PURE__*/(() => {\n  class LayoutComponent {\n    constructor() {\n      this.backgrounds = ['https://images.unsplash.com/photo-1434907652076-85f8401482c3?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1920'];\n    }\n    ngOnInit() {\n      this.dateTime = timer(0, 1000).pipe(map(() => {\n        return new Date();\n      }));\n    }\n    prepareRoute(outlet) {\n      if (outlet.isActivated) {\n        const tab = outlet.activatedRouteData['tab'];\n        if (!tab) return 'secondary';\n        return tab;\n      }\n    }\n    changeBGImage() {\n      return __awaiter(this, void 0, void 0, function* () {\n        this.loadingBGImage = true;\n        const result = yield fetch('https://source.unsplash.com/random/1920x1080', {\n          method: 'HEAD'\n        });\n        const alreadyGot = this.backgrounds.includes(result.url);\n        if (alreadyGot) {\n          // this is the same image as we currently have, so re-run the function\n          return this.changeBGImage();\n        }\n        this.backgrounds.push(result.url);\n      });\n    }\n    onBGImageLoad(imgEvent) {\n      // BG image has loaded, now remove the old BG image from the backgrounds array\n      const imgElement = imgEvent.target;\n      const src = imgElement.src;\n      this.backgrounds = this.backgrounds.filter(b => b === src);\n      this.loadingBGImage = false;\n    }\n  }\n  LayoutComponent.ɵfac = function LayoutComponent_Factory(t) {\n    return new (t || LayoutComponent)();\n  };\n  LayoutComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: LayoutComponent,\n    selectors: [[\"app-layout\"]],\n    decls: 9,\n    vars: 3,\n    consts: [[1, \"app-wrapper\"], [\"class\", \"bg-img\", 3, \"src\", \"load\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"btn change-bg-btn\", 3, \"click\", 4, \"ngIf\"], [1, \"content-section\"], [\"outlet\", \"outlet\"], [1, \"bottom-section\"], [1, \"bg-img\", 3, \"src\", \"load\"], [1, \"btn\", \"change-bg-btn\", 3, \"click\"], [1, \"material-icons\"]],\n    template: function LayoutComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵtemplate(1, LayoutComponent_img_1_Template, 1, 2, \"img\", 1);\n        i0.ɵɵtemplate(2, LayoutComponent_div_2_Template, 3, 1, \"div\", 2);\n        i0.ɵɵelementStart(3, \"div\", 3);\n        i0.ɵɵelement(4, \"router-outlet\", null, 4);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"div\", 5);\n        i0.ɵɵelement(7, \"app-tabs\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(8, \"app-notification\");\n        i0.ɵɵelementEnd();\n      }\n      if (rf & 2) {\n        const _r2 = i0.ɵɵreference(5);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", ctx.backgrounds.reverse());\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.loadingBGImage);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"@routeAnim\", ctx.prepareRoute(_r2));\n      }\n    },\n    dependencies: [i1.NgForOf, i1.NgIf, i2.RouterOutlet, i3.TabsComponent, i4.NotificationComponent],\n    styles: [\".app-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.bg-img[_ngcontent-%COMP%]{position:fixed;height:100%;width:100%;object-fit:cover;z-index:-1}.content-section[_ngcontent-%COMP%]{flex-grow:1;min-height:0}.bottom-section[_ngcontent-%COMP%]{position:fixed;bottom:0;left:50%;transform:translate(-50%);display:flex}.bottom-section[_ngcontent-%COMP%]   app-tabs[_ngcontent-%COMP%]{margin:auto}.change-bg-btn[_ngcontent-%COMP%]{position:fixed;top:10svh;right:10svh;padding:10px;background:rgba(0,0,0,.1);color:#ffffffb3}.change-bg-btn[_ngcontent-%COMP%]:hover{background:rgba(0,0,0,.3);color:#fff}.change-bg-btn[_ngcontent-%COMP%]:active{transform:translateY(1px)}\"],\n    data: {\n      animation: [trigger('routeAnim', [transition(':increment', [style({\n        position: 'relative',\n        overflow: 'hidden'\n      }), query(':enter, :leave', [baseStyles], {\n        optional: true\n      }),\n      // query(':enter', [\n      //   style({ opacity: 0 })\n      // ], { optional: true }),\n      group([query(':leave', [animate('200ms ease-in', style({\n        opacity: 0,\n        transform: 'translateX(-50px)'\n      }))], {\n        optional: true\n      }), query(':enter', [style({\n        transform: 'translateX(50px)',\n        opacity: 0\n      }), animate('250ms 120ms ease-out', style({\n        opacity: 1,\n        transform: 'translateX(0)'\n      }))], {\n        optional: true\n      })])]), transition(':decrement', [style({\n        position: 'relative',\n        overflow: 'hidden'\n      }), query(':enter, :leave', [baseStyles], {\n        optional: true\n      }),\n      // query(':enter', [\n      //   style({ opacity: 0 })\n      // ], { optional: true }),\n      group([query(':leave', [animate('200ms ease-in', style({\n        opacity: 0,\n        transform: 'translateX(50px)'\n      }))], {\n        optional: true\n      }), query(':enter', [style({\n        transform: 'translateX(-50px)',\n        opacity: 0\n      }), animate('250ms 120ms ease-out', style({\n        opacity: 1,\n        transform: 'translateX(0)'\n      }))], {\n        optional: true\n      })])]), transition('* => secondary', [style({\n        position: 'relative'\n        // overflow: 'hidden'\n      }), query(':enter, :leave', [baseStyles], {\n        optional: true\n      }), group([query(':leave', [animate('200ms ease-in', style({\n        opacity: 0,\n        transform: 'scale(0.8)'\n      }))], {\n        optional: true\n      }), query(':enter', [style({\n        transform: 'scale(1.2)',\n        opacity: 0\n      }), animate('250ms 120ms ease-out', style({\n        opacity: 1,\n        transform: 'scale(1)'\n      }))], {\n        optional: true\n      })])]), transition('secondary => *', [style({\n        position: 'relative'\n        // overflow: 'hidden'\n      }), query(':enter, :leave', [baseStyles], {\n        optional: true\n      }), group([query(':leave', [animate('200ms ease-in', style({\n        opacity: 0,\n        transform: 'scale(1.25)'\n      }))], {\n        optional: true\n      }), query(':enter', [style({\n        transform: 'scale(0.8)',\n        opacity: 0\n      }), animate('250ms 120ms ease-out', style({\n        opacity: 1,\n        transform: 'scale(1)'\n      }))], {\n        optional: true\n      })])])]), trigger('bgAnim', [transition(':leave', [animate(1000, style({\n        opacity: 0\n      }))])]), trigger('fadeAnim', [transition(':enter', [style({\n        opacity: 0\n      }), animate(250, style({\n        opacity: 1\n      }))]), transition(':leave', [animate(250, style({\n        opacity: 0\n      }))])])]\n    }\n  });\n  return LayoutComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}